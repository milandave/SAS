/*SELF JOIN*/
DATA MASTER;
INPUT NAME $ ID MID;
CARDS;
A 1  .
B 2  1
C 3  1
D 4  2
E 5  2
F 6  2
G 7  3
H 8  3
I 9  7
J 10 7
K 11 8
L 12 8
M 13 8
;
RUN;

/*SELF JOIN*/
/*CHECK EMP UNDER MGR*/
PROC SQL;
CREATE TABLE T1 AS
SELECT A.*, B.ID AS MANGER, B.NAME AS MGRNAME
FROM MASTER AS A
LEFT JOIN MASTER AS B
ON A.ID = B.MID
;
RUN;

/*CHECK MGR PER EMP*/
PROC SQL;
CREATE TABLE T1 AS
SELECT A.*, B.ID AS MANGER, B.NAME AS MGRNAME
FROM MASTER AS A
LEFT JOIN MASTER AS B
ON A.MID = B.ID
;
RUN;
