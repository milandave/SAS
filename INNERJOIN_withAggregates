/*LOGICAL SEQUENCE*/
/*FROM*/
/*WHERE*/
/*GROUP BY*/
/*HAVING*/
/*SELECT */
/*ORDER BY*/

DATA T1;
INPUT NAME $ AGE;
CARDS;
A 10
B 20
C 15
D 25
E 30
;
RUN;

DATA T2;
INPUT NAME $ MATCH $ SCORE;
CARDS;
A M1 16
B M2 100
A M2 1
;
RUN;

DATA T3;
INPUT NAME $ VENUE $ WICKETS;
CARDS;
A V1 1
D V2 2
A V3 1
;
RUN;

/*INNER JOIN TWO TABLES WITH T1 AS MASTER*/
/*INCORRECT*/
PROC SQL;
CREATE TABLE TEMP AS
SELECT DISTINCT t1.NAME, T1.AGE, SUM(T2.SCORE) AS SCORE, SUM(T3.WICKETS) AS WICKETS
FROM T1 
INNER JOIN T2 ON T1.NAME = T2.NAME
INNER JOIN T3 ON T1.NAME = T3.NAME
GROUP BY 1,2
;
RUN;

/*CORRECT*/
/*OPTION1*/
PROC SQL;
CREATE TABLE TEMP AS
SELECT DISTINCT t1.NAME, T1.AGE, SUM(T2.SCORE) AS SCORE, SUM(T3.WICKETS) AS WICKETS
FROM T1 
INNER JOIN (SELECT T2.NAME, SUM(T2.SCORE) AS SCORE FROM T2 GROUP BY T2.NAME) AS T2 ON T1.NAME = T2.NAME
INNER JOIN (SELECT T3.NAME, SUM(T3.WICKETS) AS WICKETS FROM T3 GROUP BY T3.NAME) AS T3 ON T1.NAME = T3.NAME
GROUP BY 1,2
;
RUN;

/*CORRECT*/
/*OPTION2*/
PROC SQL;
CREATE TABLE TEMP AS
SELECT DISTINCT t1.NAME, T1.AGE, SUM(T2.SCORE) AS SCORE, SUM(T3.WICKETS) AS WICKETS
FROM T1 
INNER JOIN (SELECT NAME, SUM(SCORE) AS SCORE FROM T2 GROUP BY NAME) AS T2 ON T1.NAME = T2.NAME
INNER JOIN (SELECT NAME, SUM(WICKETS) AS WICKETS FROM T3 GROUP BY NAME) AS T3 ON T1.NAME = T3.NAME
GROUP BY 1,2
;
RUN;
